# redeploy ocl-app

sudo rm -rf ocl-app
git clone https://github.com/oelarnes/ocl-app
mkdir ocl-app/data
cp -r google-auth ocl-app
cp -r events ocl-app/data
cp ocl.ini ocl-app/config
sudo service mongod start
cp owned* ocl-app/data
cp wishlist* ocl-app/data

cd ocl-app
npm install
npm run download_allsets
npm run update_database
npm run build
OCL_ENV=prod node scripts/initialize_ocl.js
sudo /opt/bitnami/ctlscript.sh stop apache
sudo /opt/bitnami/ctlscript.sh stop redis

sudo npm run start

# new dek files
# joel:~/ocl-data$

ssh ocl 'rm owned*'
ssh ocl 'rm wishlist*'
scp data/owned* ocl:~
scp data/wishlist* ocl:~
scp config/ocl.ini ocl:~
ssh ocl
rm ocl-app/config/ocl.ini
rm ocl-app/data/owned*
rm ocl-app/data/wishlist*
cp ocl.ini ocl-app/config
cp owned* ocl-app/data
cp wishlist* ocl-app/data

mutation{syncData}

# new event files

scp data/events/<eventId>/* ocl:~/events/<eventId>
scp data/events/<eventId>/* ocl:~/ocl-app/data/events/<eventId>

mutation{syncData}
